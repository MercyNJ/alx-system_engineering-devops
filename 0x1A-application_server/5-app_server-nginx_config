# Nginx configuration file for Airbnb

server {
    listen 80;
    server_name 100.25.197.219;

    # Serves airbnb-onepage route proxying to a Unix socket
    location /airbnb-onepage/ {
        include proxy_params;
        proxy_pass http://unix:/home/ubuntu/AirBnB_clone_v2/web_flask/airbnb-onepage.sock;
    }

    # Serves airbnb-dynamic/number_odd_or_even route with an int parameter
    location ~ /airbnb-dynamic/number_odd_or_even/(\d+)$ {
        include proxy_params;
        proxy_pass http://127.0.0.1:5001/number_odd_or_even/$1;
    }

    # Serves api route
    location /api/ {
        proxy_pass http://127.0.0.1:5002/api;
    }

    # Servers root
    location / {
        include proxy_params;
        proxy_pass http://unix:/home/ubuntu/AirBnB_clone_v4/web_dynamic/airbnb-webdynamic.sock;
    }

    # Serve static content for AirBnB_clone_v4
    location /static {
        proxy_pass http://127.0.0.1:5003;
    }
}
